<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>MySQL基础知识 | VIP</title>
  
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="https://xaoxuu.com/assets/img/favicon.ico">
  <link rel="alternate" href="/atom.xml" title="VIP">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <link rel="shortcut icon" href="https://xaoxuu.com/assets/img/favicon.ico">
  <link rel="icon" href="https://xaoxuu.com/assets/img/favicon.ico">
  
  <link href="https://fonts.googleapis.com/css?family=Ubuntu|Ubuntu+Mono" rel="stylesheet">
  
  <!-- <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link href="//cdn.bootcss.com/node-waves/0.7.5/waves.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
  
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?xxx";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
  
</head>
</html>
<body>
    <div id="loading-bar-wrapper">
  <div id="loading-bar" class="pure"></div>
</div>

    <script>setLoadingBarProgress(20)</script>
    <header class="l_header pure">
	<div class="wrapper">
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href="/">VIP</a>
				<div class="menu">
					<ul class="h-list">
            
    					
    						<li>
    							<a class="nav flat-box" href="https://www.ice5.vip/">
    								<i class="fas fa-home fa-fw"></i>&nbsp;主页
  								</a>
  							</li>
        			
    						<li>
    							<a class="nav flat-box" href="https://www.ice5.vip/">
    								<i class="fas fa-project-diagram fa-fw"></i>&nbsp;项目
  								</a>
  							</li>
        			
    						<li>
    							<a class="nav flat-box" href="/">
    								<i class="fas fa-paper-plane fa-fw"></i>&nbsp;博客
  								</a>
  							</li>
        			
    						<li>
    							<a class="nav flat-box" href="/archives/">
    								<i class="fas fa-folder fa-fw"></i>&nbsp;归档
  								</a>
  							</li>
        			
    						<li>
    							<a class="nav flat-box" href="https://www.ice5.vip/">
    								<i class="fas fa-users fa-fw"></i>&nbsp;关于
  								</a>
  							</li>
        			
        		
					</ul>
					<div class="underline"></div>
				</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search">
						<span class="icon"><i class="fas fa-search fa-fw"></i></span>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li>
				
				<li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>

		<div class="nav-sub container container--flex">
			<a class="logo flat-box"></a>
			<ul class="switcher h-list">
				<li class="s-comment"><a class="fas fa-comments fa-fw" href="javascript:void(0)"></a></li>
				<li class="s-top"><a class="fas fa-arrow-up fa-fw" href="javascript:void(0)"></a></li>
				<li class="s-toc"><a class="fas fa-list fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
		<nav>
      <ul>
          
              
                  <li>
										<a class="nav  flat-box" href="https://www.ice5.vip/">
											<i class="fas fa-home fa-fw"></i>&nbsp;主页
										</a>
                  </li>
              
                  <li>
										<a class="nav  flat-box" href="https://www.ice5.vip/">
											<i class="fas fa-project-diagram fa-fw"></i>&nbsp;项目
										</a>
                  </li>
              
                  <li>
										<a class="nav  flat-box" href="/">
											<i class="fas fa-paper-plane fa-fw"></i>&nbsp;博客
										</a>
                  </li>
              
                  <li>
										<a class="nav  flat-box" href="/archives/">
											<i class="fas fa-folder fa-fw"></i>&nbsp;归档
										</a>
                  </li>
              
                  <li>
										<a class="nav  flat-box" href="https://www.ice5.vip/">
											<i class="fas fa-users fa-fw"></i>&nbsp;关于
										</a>
                  </li>
              
       
      </ul>
		</nav>
	</aside>

    <script>setLoadingBarProgress(40);</script>
    <div class="l_body">
    <div class='container clearfix'>
        <div class='l_main'>
            <article id="post-MySQL" class="post white-box article-type-post" itemscope="" itemprop="blogPost">
    <section class="meta">
        
            <h1 class="title">MySQL基础知识</h1>
        
        <time class="time">
            <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
            2018-12-03
        </time>
        
          <div class="browse busuanzi"><i class="fas fa-eye fa-fw" aria-hidden="true"></i>
            <span id="busuanzi_value_page_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
          </div>
        

        
    
    <div class="cats">
        <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
        <a class="categories" href="/categories/Database/">Database</a>
    </div>


    </section>

    <section class="article typo">

        <div class="article-entry" itemprop="articleBody">
            <p>MySQL是一种关系数据库管理系统，关系数据库将数据保存在不同的表中，而不是将所有数据放在一个大仓库内，这样就<strong>增加了速度并提高了灵活性</strong>。Linux作为操作系统，Apache 或Nginx作为 Web 服务器，MySQL 作为数据库，PHP/Perl/Python作为服务器端脚本解释器。由于这四个软件都是免费或开放源码软件（FLOSS)，因此使用这种方式不用花一分钱（除开人工成本）就可以建立起一个稳定、免费的网站系统，被业界称为“LAMP“或“LNMP”组合。</p>
<a id="more"></a>
<h1 id="一、-Mysql简单认识"><a href="#一、-Mysql简单认识" class="headerlink" title="一、 Mysql简单认识"></a>一、 Mysql简单认识</h1><h2 id="1-1-数据（Data）的概念"><a href="#1-1-数据（Data）的概念" class="headerlink" title="1.1 数据（Data）的概念"></a>1.1 数据（Data）的概念</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">数据是用来描述事物的符号记录,它既可以是数字,也可以是文字、图片、图像、声音等,数据的表现形式多种多样,但它们都可以经过数字化之后存入计算机。</span><br><span class="line"><span class="comment">&lt;!-- eg --&gt;</span></span><br><span class="line">Luffu,male,18,ONE-PIECE</span><br></pre></td></tr></table></figure>
<h2 id="1-2-数据库（DataBase）的概念"><a href="#1-2-数据库（DataBase）的概念" class="headerlink" title="1.2 数据库（DataBase）的概念"></a>1.2 数据库（DataBase）的概念</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数据库是以某种有组织方式存储的数据集合,即保存有组织的数据的容器(通常是一个文件或者一组文件);可将其想象成一个文件柜,此文件柜是存放数据(不管数据是什么以及如何组织)的物理位置(计算机的存储设备上)。</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注意概念的混淆--&gt;</span></span><br><span class="line">数据库这个属于并不是人们通常使用的数据库软件,数据库软件应称为DBMS(数据库管理系统)。</span><br></pre></td></tr></table></figure>
<h2 id="1-3-表（table）"><a href="#1-3-表（table）" class="headerlink" title="1.3 表（table）"></a>1.3 表（table）</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">某种特定类型数据的结构化清单。</span><br><span class="line"><span class="comment">&lt;!-- 理解 --&gt;</span></span><br><span class="line">存储在表中的数据是一种类型的数据或者一个清单</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 表名的唯一性 --&gt;</span></span><br><span class="line">表明一般是用来标识自己的,其唯一性取决于多方面,可以是数据库名和表明的结合;虽然在同一个数据库中不能命名两个同样的表明,但是在不同的数据库中却可以使用相同的表明。</span><br></pre></td></tr></table></figure>
<h2 id="1-4-记录"><a href="#1-4-记录" class="headerlink" title="1.4 记录"></a>1.4 记录</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 列 --&gt;</span></span><br><span class="line">表中的一个字段,所有的表都是由一个或者多个列组成的,每个列都应该有相应的数据类型(datatype)。</span><br><span class="line"><span class="comment">&lt;!-- 分解数据 --&gt;</span></span><br><span class="line">可以将多个不同的数据分解成不同的列,这样更易于区分,也有利于对数据的筛选和处理</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 行 --&gt;</span></span><br><span class="line">表中的一条记录,经常有人将行(row)称作数据库记录(record),通常来说,这俩术语是可以通用的;但从计数上来说,行才是其正确的术语。</span><br><span class="line"><span class="comment">&lt;!-- 数据存储 --&gt;</span></span><br><span class="line">表中的数据都是按行存储的,所保存的每个记录存储在自己的行内。</span><br></pre></td></tr></table></figure>
<h2 id="1-5-主键（primary-key）"><a href="#1-5-主键（primary-key）" class="headerlink" title="1.5 主键（primary key）"></a>1.5 主键（primary key）</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">一列(或一组列),其值能够唯一的区分表中的每个行;每一行都应该有可以唯一标识自己的一列(或一组列),唯一标识表中每行的这个列(或这组列)称为主键</span><br><span class="line"><span class="comment">&lt;!-- 主键规则 --&gt;</span></span><br><span class="line">a.任意两行都不具有相同的主键值;</span><br><span class="line">b.每个行都必须具有一个主键值(主键列不允许有 NULL 值)。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 选择主键的好习惯 --&gt;</span></span><br><span class="line">a.不更新主键列中的值;</span><br><span class="line">b.不重用主键列的值;</span><br><span class="line">c.不在逐渐列中使用可能会更改的值</span><br></pre></td></tr></table></figure>
<h2 id="1-6-数据库服务器、数据库管理系统、数据库、表与记录的关系-重点在于理解"><a href="#1-6-数据库服务器、数据库管理系统、数据库、表与记录的关系-重点在于理解" class="headerlink" title="1.6 数据库服务器、数据库管理系统、数据库、表与记录的关系(重点在于理解)"></a>1.6 数据库服务器、数据库管理系统、数据库、表与记录的关系(重点在于理解)</h2><ul>
<li>数据库服务器：计算机(对内存要求较高)</li>
<li>数据库管理系统：如MySQL、Oracle、SQLite、Access、MS SQL Server  (一个软件)</li>
<li>数据库：product（即文件夹）</li>
<li>表：product_list（文件夹当中的文件）</li>
<li>记录：1 《MySQL必知必会》978-7-115-19112-0  39  （由多个字段组成的信息,即文件中的一行内容）</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 总结 --&gt;</span></span><br><span class="line">数据库服务器：运行数据库管理软件</span><br><span class="line">数据库管理系统：管理数据库的软件</span><br><span class="line">数据库：即文件夹,用来组织文件/表</span><br><span class="line">表：即文件,用来存放多行内容/多条记录</span><br></pre></td></tr></table></figure>
<h1 id="2-SQL的概念"><a href="#2-SQL的概念" class="headerlink" title="2 SQL的概念"></a>2 SQL的概念</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Structured Query Language --&gt;</span></span><br><span class="line">SQL是结构化的查询语言,是一种专门用来与数据库通信的语言。</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- SQL优点 --&gt;</span></span><br><span class="line">a.不是某个特定供应商专有语言,几乎所有的数据库都适用;</span><br><span class="line">b.由描述性很强的英语单词组成,简单易学;</span><br><span class="line">c.看上去简单,实际上是一种强有力的语言,灵活使用,可进行非常复杂和高级的数据库操作。</span><br></pre></td></tr></table></figure>
<h1 id="二、-Mysql基础操作"><a href="#二、-Mysql基础操作" class="headerlink" title="二、 Mysql基础操作"></a>二、 Mysql基础操作</h1><h2 id="1-连接MySQL"><a href="#1-连接MySQL" class="headerlink" title="1 连接MySQL"></a>1 连接MySQL</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--需要信息--&gt;</span></span><br><span class="line">a.主机名（计算机名）,若连接的是本地 MySQL 服务器,为 localhost;</span><br><span class="line">b.端口（如果使用默认端口3306之外的端口）;</span><br><span class="line">c.合法的用户名</span><br><span class="line">d.用户口令（非必须）</span><br></pre></td></tr></table></figure>
<h2 id="2-选择数据库"><a href="#2-选择数据库" class="headerlink" title="2 选择数据库"></a>2 选择数据库</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--use关键字--&gt;</span></span><br><span class="line">use 库名;</span><br><span class="line"><span class="comment">&lt;!--注意--&gt;</span></span><br><span class="line">一定要加英文状态下的分号,否则进不去,因为在 MySQL 中是用分号来表示结束的</span><br></pre></td></tr></table></figure>
<h2 id="3-常用数据库和表的SQL-语句"><a href="#3-常用数据库和表的SQL-语句" class="headerlink" title="3 常用数据库和表的SQL 语句"></a>3 常用数据库和表的SQL 语句</h2><table>
<thead>
<tr>
<th style="text-align:center">SQL语句</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">showdatabases;</td>
<td style="text-align:center">显示数据库名称</td>
</tr>
<tr>
<td style="text-align:center">show create database 库名;</td>
<td style="text-align:center">显示特定数据库的结构以及基本信息</td>
</tr>
<tr>
<td style="text-align:center">show tables;</td>
<td style="text-align:center">获得数据库中的所有表的列表</td>
</tr>
<tr>
<td style="text-align:center">show create table 表名;</td>
<td style="text-align:center">显示特定表的结构以及基本信息</td>
</tr>
<tr>
<td style="text-align:center">describe 表名(简写成desc 表名);</td>
<td style="text-align:center">对每个字段返回一行,行中包括字段名、数据类型、是否允许NULL等信息</td>
</tr>
<tr>
<td style="text-align:center">show columns from 表名;</td>
<td style="text-align:center">desc 表名的另一种写法</td>
</tr>
<tr>
<td style="text-align:center">———————————————-</td>
<td style="text-align:center">—————————————————————————————————–</td>
</tr>
<tr>
<td style="text-align:center">show status;</td>
<td style="text-align:center">显示广泛的服务器状态信息</td>
</tr>
<tr>
<td style="text-align:center">show grant;</td>
<td style="text-align:center">显示授予用户的安全权限</td>
</tr>
<tr>
<td style="text-align:center">show error;</td>
<td style="text-align:center">显示服务器错误</td>
</tr>
<tr>
<td style="text-align:center">show warnings;</td>
<td style="text-align:center">显示服务器警告</td>
</tr>
</tbody>
</table>
<h1 id="三、-检索数据"><a href="#三、-检索数据" class="headerlink" title="三、 检索数据"></a>三、 检索数据</h1><h2 id="1-select语句"><a href="#1-select语句" class="headerlink" title="1 select语句"></a>1 select语句</h2><table>
<thead>
<tr>
<th>select语句</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>select * from 表名;</td>
<td>检索所有的列</td>
</tr>
<tr>
<td>select column from 表名;</td>
<td>从表中检索出单个列</td>
</tr>
<tr>
<td>select column1,column2 from 表名;</td>
<td>从表中检索出多个列</td>
</tr>
<tr>
<td>——————————————————————–</td>
<td>——————————————————————-</td>
</tr>
<tr>
<td>select distinct row from 表名;</td>
<td>从表中检索出不同的行</td>
</tr>
<tr>
<td>select * from 表名 limit 5;</td>
<td>检索单个列,且只从表开始部分检索出5条数据</td>
</tr>
<tr>
<td>select * from 表名 limit 5,5;</td>
<td>表示从表中第五行开始检索出5行的记录</td>
</tr>
<tr>
<td>select * from 表名 limit 5 offset 3;</td>
<td>表示从第3行开始去3条记录</td>
</tr>
<tr>
<td>select 表名.column from 表名;</td>
<td>从指定的表名中检索出指定的列数据</td>
</tr>
</tbody>
</table>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注意--&gt;</span></span><br><span class="line">a.SQL 语句不区分大小写,但是对于 SQL 关键字使用大写,对所有列和表名使用小写,可以是代码易于阅读。</span><br><span class="line">b.选择多个列时,注意在列名之间加上逗号,但最后一个列名不加逗号。</span><br><span class="line">c.通配符 * 不要随意使用,严重降低检索效率。</span><br><span class="line">d.行0检索出来的是第一行而不是行1,所以 limit 1,将检索出第二行而不是第一行,若行数不够则只能返回能得到的行数。</span><br></pre></td></tr></table></figure>
<h2 id="2-排序检索数据"><a href="#2-排序检索数据" class="headerlink" title="2 排序检索数据"></a>2 排序检索数据</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--子句的概念--&gt;</span></span><br><span class="line">SQL语句是由子句构成的,通常由关键字和所提供的数据组成的,有些子句是必须的,有些子句是可选的。</span><br><span class="line"><span class="comment">&lt;!--排序的子句--&gt;</span></span><br><span class="line">order by:只能位于 from 子句之后,但是在limit之前。</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">SQL语句</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">select pro_name from products order by pro_name;</td>
<td style="text-align:center">从表products中选取pro_name这一列并按照pro_name排序</td>
</tr>
<tr>
<td style="text-align:center">select pro_id,pro_name,pro_price from products order by pro_price,pro_name;</td>
<td style="text-align:center">从表中选择数据并按照价格姓名排序,若在价格相同的情况下,继续使用姓名排序。</td>
</tr>
<tr>
<td style="text-align:center">select pro_price from products order by pro_price desc;</td>
<td style="text-align:center">从表中检索出数据并按照价格降序进行排序</td>
</tr>
<tr>
<td style="text-align:center">select pro_price from products order by pro_price asc;</td>
<td style="text-align:center">从表中检索出数据并按照价格升序进行排序,一般默认情况就是升序。</td>
</tr>
</tbody>
</table>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--多个列上进行降序排列--&gt;</span></span><br><span class="line">desc只直接作用于其前面的列,若想在多个列上进行降序排序,必须对每个列指定desc关键字。</span><br></pre></td></tr></table></figure>
<h2 id="3-过滤数据"><a href="#3-过滤数据" class="headerlink" title="3 过滤数据"></a>3 过滤数据</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- where --&gt;</span></span><br><span class="line">只返回指定条件的记录</span><br><span class="line"><span class="comment">&lt;!-- between ... and ... --&gt;</span></span><br><span class="line">只返回范围内的开始值和结束值(不包括开头和结尾)</span><br><span class="line"><span class="comment">&lt;!-- 空值 --&gt;</span></span><br><span class="line">NULL:无值,它与字段中包含0,空字符串、或仅仅包含空格不同。</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">SQL语句</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">select * from products where id=2;</td>
<td style="text-align:center">从表中检索出id=2的记录</td>
</tr>
<tr>
<td style="text-align:center">select * from poducts where id between 5 and 10;</td>
<td style="text-align:center">从表中检索出id在5-10之间的记录</td>
</tr>
<tr>
<td style="text-align:center">select * from products where email is null;</td>
<td style="text-align:center">从表中检索出email是空值的记录</td>
</tr>
</tbody>
</table>
<h2 id="4-数据过滤升级"><a href="#4-数据过滤升级" class="headerlink" title="4 数据过滤升级"></a>4 数据过滤升级</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 操作符 --&gt;</span></span><br><span class="line">用来联结或改变where子句中的子句关键字。</span><br><span class="line"><span class="comment">&lt;!-- and --&gt;</span></span><br><span class="line">用在where子句中的关键字,用来只是检索满足所有给定条件的行。</span><br><span class="line"><span class="comment">&lt;!-- or --&gt;</span></span><br><span class="line">用在where子句中的关键字,用来表示检索匹配任一给定条件的行。</span><br><span class="line"><span class="comment">&lt;!-- in --&gt;</span></span><br><span class="line">where子句中用来指定要匹配值的清单的关键字,功能与or相当。</span><br><span class="line"><span class="comment">&lt;!-- not --&gt;</span></span><br><span class="line">where子句中用来否定后跟条件的关键字。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- and和or的优先级 --&gt;</span></span><br><span class="line">在and和or同时使用时,and的优先级高于or,若想检索出的结果不被打乱,可以加上括号。</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>SQL语句</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>select * from products where id=2 and price=123;</td>
<td>检索出同时是id=2和price=123的记录</td>
</tr>
<tr>
<td>select * from products where id=2 or price=123;</td>
<td>检索出id=2或者price=123的记录</td>
</tr>
<tr>
<td>select pro_name from products where id in (1,2,3,4,5);</td>
<td>检索出id在1-5范围内的pro_name</td>
</tr>
<tr>
<td>select pro_name from products where id not in (1,2,3,4,5);</td>
<td>检索出id不在1-5范围内的pro_name</td>
</tr>
</tbody>
</table>
<h2 id="5-用通配符进行过滤"><a href="#5-用通配符进行过滤" class="headerlink" title="5 用通配符进行过滤"></a>5 用通配符进行过滤</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--通配符--&gt;</span></span><br><span class="line">用来匹配值的一部分的特殊字符</span><br><span class="line"><span class="comment">&lt;!--搜索模式--&gt;</span></span><br><span class="line">由字面值、通配符或者两者组合构成的搜索条件</span><br><span class="line"><span class="comment">&lt;!--注意--&gt;</span></span><br><span class="line">通配符的位置会影响到结果,使用时应注意通配符的位置</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">通配符</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">like</td>
<td style="text-align:center">严格意义上like是谓词,而不是操作符</td>
</tr>
<tr>
<td style="text-align:center">%</td>
<td style="text-align:center">可以匹配多个任意字符,根据位置不同而不同</td>
</tr>
<tr>
<td style="text-align:center">_</td>
<td style="text-align:center">可以匹配单个任意字符</td>
</tr>
</tbody>
</table>
<h2 id="6-正则"><a href="#6-正则" class="headerlink" title="6 正则"></a>6 正则</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 写法 --&gt;</span></span><br><span class="line">select sth from table where sth REGEXP '正则表达式' order by sth;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- LIKE与REGEXP的区别 --&gt;</span></span><br><span class="line">LIKE匹配整个列,若匹配的文本在列中,LIKE不会找到它,所以就不会有结果返回;REGEXP在列之内进行匹配,若被匹配的文本在列值中出现,REGEXP将会找到并返回这个文本。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- '1|2 3'和'[12] 3'的区别 --&gt;</span></span><br><span class="line">'1|2 3'  表示的是匹配 '1' 或者 '2 3';</span><br><span class="line">'[12] 3' 表示的是匹配 '1 3' 或者 '2 3'</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- MySQL中的转义符与其他正则表达式中的转义符 --&gt;</span></span><br><span class="line">MySQL中需要使用两个 \\ 来表示转义符,如 \\- 表示 - , \\. 表示 . ;</span><br><span class="line">其他正则表示是用 \ 来表示转义符。</span><br></pre></td></tr></table></figure>
<h1 id="四、-字段"><a href="#四、-字段" class="headerlink" title="四、 字段"></a>四、 字段</h1><h2 id="1-字段"><a href="#1-字段" class="headerlink" title="1 字段"></a>1 字段</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 字段 --&gt;</span></span><br><span class="line">与列的意思基本上相同,不过数据库列一般称为列,而术语字段通常用在计算字段连接上。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 拼接 --&gt;</span></span><br><span class="line">将值联结到一起构成单个值。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- MySQL的不同之处 --&gt;</span></span><br><span class="line">多数的DBMS使用 + 或 || 实现字符串拼接,而MySQL是使用Concat()函数来实现。当将SQL语句转成MySQL时需要注意。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Trim()函数 --&gt;</span></span><br><span class="line">去掉两边的空格</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用别名 --&gt;</span></span><br><span class="line">在实际的表列明包含不符合规定的字符时重新命名它。</span><br></pre></td></tr></table></figure>
<h1 id="五、-聚合函数"><a href="#五、-聚合函数" class="headerlink" title="五、 聚合函数"></a>五、 聚合函数</h1><h2 id="1-聚合函数"><a href="#1-聚合函数" class="headerlink" title="1 聚合函数"></a>1 聚合函数</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 聚合函数 --&gt;</span></span><br><span class="line">运行在行组上,计算和返回单个值的函数。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 列值为NULL的行 --&gt;</span></span><br><span class="line">函数将忽略列值为NULL的行</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">avg()</td>
<td style="text-align:center">返回某列的平均值,若需要多个列的平均值,需要多个avg()函数</td>
</tr>
<tr>
<td style="text-align:center">count()</td>
<td style="text-align:center">返回某列的行数</td>
</tr>
<tr>
<td style="text-align:center">max()</td>
<td style="text-align:center">返回某列的最大值</td>
</tr>
<tr>
<td style="text-align:center">min()</td>
<td style="text-align:center">返回某列的最小值</td>
</tr>
<tr>
<td style="text-align:center">sum()</td>
<td style="text-align:center">返回某列值之和</td>
</tr>
</tbody>
</table>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 聚集不同的值 DISTINCT --&gt;</span></span><br><span class="line">a.指定列名,则distinct只能用于count()。distinct不能用于count(*) ,因此不允许使用count(distinct),否则产生错误。</span><br><span class="line">b.将distinct用于max()和min()从技术上可用,但是没有实际价值。</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 组合聚合函数 --&gt;</span></span><br><span class="line">可以同时使用多个聚合函数。</span><br></pre></td></tr></table></figure>
<h1 id="六、-数据分组"><a href="#六、-数据分组" class="headerlink" title="六、 数据分组"></a>六、 数据分组</h1><h2 id="1-创建分组"><a href="#1-创建分组" class="headerlink" title="1 创建分组"></a>1 创建分组</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- group by的规定 --&gt;</span></span><br><span class="line">a.group by子句可以包含任意数目的列,可以对分组进行嵌套,为数据分组提供更细致的控制。</span><br><span class="line">b.若在group by子句中潜逃了分组,数据将在最后规定的分组上进行汇总。</span><br><span class="line">c.group by子句中的每个列都必须是检索列或者有效的表达式(不能是聚合函数)。</span><br></pre></td></tr></table></figure>
<h2 id="2-过滤分组"><a href="#2-过滤分组" class="headerlink" title="2 过滤分组"></a>2 过滤分组</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- having与where的区别 --&gt;</span></span><br><span class="line">where:在数据分组前进行过滤,过滤的是行;</span><br><span class="line">having:在数据分组之后进行过滤,过滤的是分组。</span><br></pre></td></tr></table></figure>
<h2 id="3-分组和排序"><a href="#3-分组和排序" class="headerlink" title="3 分组和排序"></a>3 分组和排序</h2><table>
<thead>
<tr>
<th style="text-align:center">order by</th>
<th style="text-align:center">group by</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">排序产生的输出</td>
<td style="text-align:center">分组行,输出的可能不是分组的顺序</td>
</tr>
<tr>
<td style="text-align:center">任意列都可使用</td>
<td style="text-align:center">只可使用选择列或表达式列,而且必须使用每个选择列表达式。</td>
</tr>
<tr>
<td style="text-align:center">不一定需要</td>
<td style="text-align:center">若与聚合函数配合使用,则必须使用</td>
</tr>
</tbody>
</table>
<h1 id="七、-关键词执行顺序汇总"><a href="#七、-关键词执行顺序汇总" class="headerlink" title="七、 关键词执行顺序汇总"></a>七、 关键词执行顺序汇总</h1><table>
<thead>
<tr>
<th style="text-align:center">子句</th>
<th style="text-align:center">说明</th>
<th style="text-align:center">是否必要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">select</td>
<td style="text-align:center">返回的列或者表达式</td>
<td style="text-align:center">√</td>
</tr>
<tr>
<td style="text-align:center">distinct</td>
<td style="text-align:center">去除重复的值</td>
<td style="text-align:center">×</td>
</tr>
<tr>
<td style="text-align:center">from</td>
<td style="text-align:center">从中检索数据的表</td>
<td style="text-align:center">仅在从表中选择数据是使用</td>
</tr>
<tr>
<td style="text-align:center">where</td>
<td style="text-align:center">行级过滤</td>
<td style="text-align:center">×</td>
</tr>
<tr>
<td style="text-align:center">group by</td>
<td style="text-align:center">分组的说明</td>
<td style="text-align:center">仅在按组计算聚合时使用</td>
</tr>
<tr>
<td style="text-align:center">having</td>
<td style="text-align:center">组级过滤</td>
<td style="text-align:center">×</td>
</tr>
<tr>
<td style="text-align:center">order by</td>
<td style="text-align:center">输出的顺序排序</td>
<td style="text-align:center">×</td>
</tr>
<tr>
<td style="text-align:center">limit</td>
<td style="text-align:center">需要检索出的具体行数</td>
<td style="text-align:center">×</td>
</tr>
</tbody>
</table>
<h1 id="八、-子查询和组合查询"><a href="#八、-子查询和组合查询" class="headerlink" title="八、 子查询和组合查询"></a>八、 子查询和组合查询</h1><h2 id="1-子查询"><a href="#1-子查询" class="headerlink" title="1 子查询"></a>1 子查询</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 子查询 --&gt;</span></span><br><span class="line">将一条select语句的执行结果用于另一条select语句的whereas子句</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 注意 --&gt;</span></span><br><span class="line">使用子查询时,列必须匹配。在where子句中使用子查询,应保证select语句具有与where子句中相同数目的列。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 相关子查询 --&gt;</span></span><br><span class="line">涉及外部查询的子查询;如 where table1.id = table2.new_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 操作符 --&gt;</span></span><br><span class="line">in   =    !=</span><br><span class="line">select c_name where c_id in (select c_id from table1 where c_id != 0) from table2 roder by c_name;</span><br></pre></td></tr></table></figure>
<h2 id="2-组合查询"><a href="#2-组合查询" class="headerlink" title="2 组合查询"></a>2 组合查询</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 组合查询的使用 --&gt;</span></span><br><span class="line">a.在单个查询中从不同的表返回类似结构的数据;</span><br><span class="line">b.对单个表执行多个查询,按单个查询返回数据。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- union规则 --&gt;</span></span><br><span class="line">a.union必须由两条或者两条以上的select语句组成,语句间用关键字union分隔。</span><br><span class="line">b.union中的每个查询必须包含相同列、表达式或聚合函数。</span><br><span class="line">c.类数据类型必须兼容：类型不必完全相同,但必须是DBMS可以隐含地转换的类型。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用union --&gt;</span></span><br><span class="line">给出每条select语句,在语句之间放上关键字union</span><br><span class="line">select c_name from table1 where c_id&gt;0;</span><br><span class="line">select p_name from table2 where p_id between 5 and 10;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select c_name from table1 where c_id&gt;0</span><br><span class="line">union</span><br><span class="line">select p_name from table2 where p_id between 5 and 10;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 包含或取消重复的行 --&gt;</span></span><br><span class="line">可以使用union all来显示出所有的行</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 对组合查询结果排序 --&gt;</span></span><br><span class="line">使用union查询时,只能使用一条order by子句,且必须出现在最后一条select语句之后。</span><br></pre></td></tr></table></figure>
<h1 id="九、-联结表和创建高级联结"><a href="#九、-联结表和创建高级联结" class="headerlink" title="九、 联结表和创建高级联结"></a>九、 联结表和创建高级联结</h1><h2 id="1-联结"><a href="#1-联结" class="headerlink" title="1 联结"></a>1 联结</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 外键 --&gt;</span></span><br><span class="line">外键为某个表中的一列,包含另外一个表的主键值,定义了两个表之间的关系。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 可伸缩性 --&gt;</span></span><br><span class="line">能够适应不断增加的工作量而不失败,设计良好的数据库或应用程序称之为可伸缩性好。</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 创建联结 --&gt;</span></span><br><span class="line">select c_name,c_addr,p_name from customer,product where customer.c_id = products.p_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 内部联结 --&gt;</span></span><br><span class="line">select c_name,p_name,p_price from customer inner join products on customer.c_id = products.p_id;</span><br></pre></td></tr></table></figure>
<h2 id="2-高级联结"><a href="#2-高级联结" class="headerlink" title="2 高级联结"></a>2 高级联结</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 自联结 --&gt;</span></span><br><span class="line">自联结通常作为外部语句用来替代从相同表中检索数据时使用的子查询语句。</span><br><span class="line">子查询解决方案:select p_name from products where c_id in (select c_id from customer where p_id=10);</span><br><span class="line">联结查询:select p.p_name from customer as c,products as p where p.p_id = c.c_id and c.c_id=10;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 自然联结 --&gt;</span></span><br><span class="line">无论何时对表进行联结,应至少有一个列出现在不知一个表中(被联结的列)。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 外部联结 --&gt;</span></span><br><span class="line">将一个表中的行与另外一个表中的行相关联,包含没有关联行的那些行。</span><br><span class="line">语法与内部联结相似,left outer join 或者 right outer join</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 带有聚合函数的联结 --&gt;</span></span><br><span class="line">select c.c_name,c.c_id count(o.order_num) as num_ord from customer as c inner join orders as o on c.c_id = o.c_id;</span><br></pre></td></tr></table></figure>
<h1 id="十、-数据操作"><a href="#十、-数据操作" class="headerlink" title="十、 数据操作"></a>十、 数据操作</h1><h2 id="1-插入数据"><a href="#1-插入数据" class="headerlink" title="1 插入数据"></a>1 插入数据</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 插入数据 --&gt;</span></span><br><span class="line">a.insert into tablename values (value1,value2,...)</span><br><span class="line">b.insert into tablename(字段1,字段2,...) values (value1,value2,...)</span><br><span class="line">a 的语法虽然简单但是不安全,应尽量避免使用。b 的语法复杂但是更安全,且不用根据表结构来插入数据了。</span><br></pre></td></tr></table></figure>
<h2 id="2-更新数据"><a href="#2-更新数据" class="headerlink" title="2 更新数据"></a>2 更新数据</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 更新数据 --&gt;</span></span><br><span class="line">update tablename set 字段名1 = value1,</span><br><span class="line">					[字段名2 = value2,</span><br><span class="line">					...</span><br><span class="line">					]</span><br><span class="line">					where 字段名 = value;</span><br><span class="line"><span class="comment">&lt;!-- 注意 --&gt;</span></span><br><span class="line">使用update时应该配合使用where语句,若没有where语句,MySQL将会更细心表中的所有数据。</span><br></pre></td></tr></table></figure>
<h2 id="3-删除数据"><a href="#3-删除数据" class="headerlink" title="3 删除数据"></a>3 删除数据</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 删除数据 --&gt;</span></span><br><span class="line">delete from tablename where 字段名 = value;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 注意 --&gt;</span></span><br><span class="line">delete删除的是行</span><br><span class="line">使用delete时应该配合使用where语句,若没有where语句,MySQL将会更细心表中的所有数据。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 快速的删除所有行 --&gt;</span></span><br><span class="line">使用truncate table,实际上是删除原来的表并重新创建一个表,而不是逐行的删除数据。</span><br></pre></td></tr></table></figure>
<h1 id="十一、-表操作"><a href="#十一、-表操作" class="headerlink" title="十一、 表操作"></a>十一、 表操作</h1><h2 id="1-创建表"><a href="#1-创建表" class="headerlink" title="1 创建表"></a>1 创建表</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 创建表 --&gt;</span></span><br><span class="line">create table tablename[if not exists](</span><br><span class="line">					id int primary_key auto_increment,</span><br><span class="line">					name varchar(32) not null,</span><br><span class="line">					password varchar(64) nul null default="123",</span><br><span class="line">					) ENGINE = InnoDB;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 需要知道的引擎 --&gt;</span></span><br><span class="line">InnoDB:可靠地事物处理引擎,不支持全文本搜索;</span><br><span class="line">MEMORY:功能等同于MyISAM,由于数据存储在内存中,速度很快,但是断电就丢失(适合用于临时表);</span><br><span class="line">MyISAM:性能极高,支持全文本搜索,但不支持事物处理。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 注意 --&gt;</span></span><br><span class="line">外键不能跨引擎,混用引擎有缺陷,外键不能跨引擎,即一个使用引擎的表不能引用具有不同引擎的表的外键。</span><br></pre></td></tr></table></figure>
<h2 id="2-更新表"><a href="#2-更新表" class="headerlink" title="2 更新表"></a>2 更新表</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 添加列 --&gt;</span></span><br><span class="line">alter table tablename add 字段1 类型</span><br><span class="line">						[,字段2 类型]</span><br><span class="line">						...</span><br><span class="line"><span class="comment">&lt;!-- 删除列 --&gt;</span></span><br><span class="line">alter table tablename drop column 字段;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- alter table常见用途 --&gt;</span></span><br><span class="line">用来定义外键,alter table talbename add constraint fk_tablename1_tablename2 foreign key (tablename2的字段id) refernces tablename2的字段 (tablename2的字段id)</span><br><span class="line"></span><br><span class="line">alter table orderitems add constraint fk_orderitems_orders foreign key (order_num) references orders(order_num);</span><br></pre></td></tr></table></figure>
<h2 id="3-删除表"><a href="#3-删除表" class="headerlink" title="3 删除表"></a>3 删除表</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 删除表 --&gt;</span></span><br><span class="line">drop table tablename;</span><br></pre></td></tr></table></figure>
<h2 id="4-重命名表"><a href="#4-重命名表" class="headerlink" title="4 重命名表"></a>4 重命名表</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 重命名表 --&gt;</span></span><br><span class="line">rename table oldtablename to newtablename;</span><br></pre></td></tr></table></figure>
<h1 id="十二、-视图"><a href="#十二、-视图" class="headerlink" title="十二、 视图"></a>十二、 视图</h1><h2 id="1-视图"><a href="#1-视图" class="headerlink" title="1 视图"></a>1 视图</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 视图 --&gt;</span></span><br><span class="line">视图是一个虚拟的表,与包含数据的表是不一样的,视图只包含使用时动态检索数据的查询。所以,对视图进行增加或者删除操作,实际上是对其基表进行增加或者删除。但是视图一般都是用来检索,而不是用来更新。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 视图的常见应用 --&gt;</span></span><br><span class="line">a.重用SQL语句</span><br><span class="line">b.简化复杂的SQL操作。即编写查询之后,可以更方便的重用它而了解它的基本查询细节</span><br><span class="line">c.使用的是表的组成部分而不是整个表</span><br><span class="line">d.保护数据,可以给用户授予表的特定部分的访问权限而不是整个表的访问权限</span><br><span class="line">e.更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--视图的使用--&gt;</span></span><br><span class="line">创建视图：create view viewname as </span><br><span class="line">		select ...</span><br><span class="line">		;</span><br><span class="line">查看视图：show create view viewname;</span><br><span class="line">更新视图：create or replace view; 或者先 drop 再 create</span><br><span class="line">删除视图：drop view viewname;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 更新视图的注意点 --&gt;</span></span><br><span class="line">并非所有的视图都是可以更新的。若MySQL不能准确地确定被更新的 基数据,则不允许更新。则视图定义中有一下操作时,不能进行视图更新：</span><br><span class="line">a.分组(group by 和 having)</span><br><span class="line">b.联结</span><br><span class="line">c.子查询</span><br><span class="line">d.并</span><br><span class="line">e.聚合函数</span><br><span class="line">f.distinct</span><br><span class="line">g.导出列</span><br><span class="line">上述的限制只限于MySQL5以前,之后可能会更改。</span><br></pre></td></tr></table></figure>
<h1 id="十三、-游标"><a href="#十三、-游标" class="headerlink" title="十三、 游标"></a>十三、 游标</h1><h2 id="1-游标"><a href="#1-游标" class="headerlink" title="1 游标"></a>1 游标</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用游标注意事项 --&gt;</span></span><br><span class="line">游标只能用于存储过程。不像多数DBMS,MySQL游标只能使用于存储过程和函数。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用游标的步骤 --&gt;</span></span><br><span class="line">a.先声明(定义)游标,这个过程并没有检索数据,只是定义了使用的SELECT语句。</span><br><span class="line">b.打开游标以供使用。这个过程将定义的SELECT语句将数据检索出来。</span><br><span class="line">c.对于填有数据的游标,根据需要检索各行。</span><br><span class="line">d.结束游标使用时,关闭游标。</span><br></pre></td></tr></table></figure>
<h2 id="2-使用游标"><a href="#2-使用游标" class="headerlink" title="2 使用游标"></a>2 使用游标</h2><h4 id="2-1-创建游标"><a href="#2-1-创建游标" class="headerlink" title="2.1 创建游标"></a>2.1 创建游标</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorders()</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE ordernumbers CURSOR  <span class="comment">&lt;!--declare命名游标--&gt;</span></span><br><span class="line">	FOR</span><br><span class="line">	SELECT order_num FROM orders;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 注意 --&gt;</span></span><br><span class="line">存储过程处理完成之后,游标就会消失。</span><br></pre></td></tr></table></figure>
<h4 id="2-2-打开和关闭游标"><a href="#2-2-打开和关闭游标" class="headerlink" title="2.2 打开和关闭游标"></a>2.2 打开和关闭游标</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 打开 --&gt;</span></span><br><span class="line">OPEN ordernumbers;</span><br><span class="line"><span class="comment">&lt;!-- 关闭 --&gt;</span></span><br><span class="line">CLOSE ordernumbers;  <span class="comment">&lt;!--关闭所有内部内存和资源--&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-3-使用游标数据"><a href="#2-3-使用游标数据" class="headerlink" title="2.3 使用游标数据"></a>2.3 使用游标数据</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorder()</span><br><span class="line">BEGIN</span><br><span class="line">	<span class="comment">&lt;!--Declare local variable--&gt;</span></span><br><span class="line">	DECLARE ordernumers CURSOR</span><br><span class="line">	DECLARE done BOOLEAN DEFAULT 0;</span><br><span class="line">	DECLARE o INT;</span><br><span class="line">	DECLARE t DECIMAL(8,2);</span><br><span class="line">	<span class="comment">&lt;!--Declare the cursor--&gt;</span></span><br><span class="line">	DECLARE ordernumbers CURSOR</span><br><span class="line">	FOR</span><br><span class="line">	SELECT order_num FORM orders;</span><br><span class="line">	<span class="comment">&lt;!--Declare continue handler--&gt;</span></span><br><span class="line">	DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET done=1; <span class="comment">&lt;!--循环的结束条件--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--Create a table to store the results--&gt;</span></span><br><span class="line">	CREATE TABLE IF NOT EXISTS ordertotals</span><br><span class="line">		(order_num INT, total DECIMAL(8,2));</span><br><span class="line">	<span class="comment">&lt;!--Open the cursor--&gt;</span></span><br><span class="line">	OPEN ordernumbers;</span><br><span class="line">	<span class="comment">&lt;!--Loop through all rows--&gt;</span></span><br><span class="line">	REPEAT</span><br><span class="line">		<span class="comment">&lt;!--Get order number--&gt;</span></span><br><span class="line">		FETCH ordernumvers INTO O; <span class="comment">&lt;!--使用fetch检索order_num直至done为真--&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--Get the total for this order--&gt;</span></span><br><span class="line">		CALL ordertotal(o, 1, t);</span><br><span class="line">		<span class="comment">&lt;!--Insert order and total into ordertotals--&gt;</span></span><br><span class="line">		INSERT INTO ordertotals(order_num, total) VALUES(o, t);</span><br><span class="line">		<span class="comment">&lt;!--End of loop--&gt;</span></span><br><span class="line">		UNTIL done END REPEAT;</span><br><span class="line">		<span class="comment">&lt;!--Close the cursor--&gt;</span></span><br><span class="line">		CLOSE ordernumbers;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
<h1 id="十五、-触发器"><a href="#十五、-触发器" class="headerlink" title="十五、 触发器"></a>十五、 触发器</h1><h2 id="1-触发器"><a href="#1-触发器" class="headerlink" title="1 触发器"></a>1 触发器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 触发器 --&gt;</span></span><br><span class="line">在某个表发生变化时另一个表更改时自动处理</span><br><span class="line"><span class="comment">&lt;!-- 支持语句 --&gt;</span></span><br><span class="line">DELETE</span><br><span class="line">INSERT</span><br><span class="line">UPDATE</span><br><span class="line">其他语句不支持触发器</span><br></pre></td></tr></table></figure>
<h2 id="2-创建触发器"><a href="#2-创建触发器" class="headerlink" title="2 创建触发器"></a>2 创建触发器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定条件 --&gt;</span></span><br><span class="line">a.唯一的触发器名</span><br><span class="line">b.触发器关联的表</span><br><span class="line">c.触发器应该相应的活动</span><br><span class="line">d.触发器何时执行</span><br><span class="line"><span class="comment">&lt;!-- 语法 --&gt;</span></span><br><span class="line">CREATE TRIGGER newproduct AFTER INSERT ON products FOR EACH ROW SELECT 'Product added';</span><br><span class="line"><span class="comment">&lt;!-- 触发器支持的只有表,视图不支持 --&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="3-删除触发器"><a href="#3-删除触发器" class="headerlink" title="3 删除触发器"></a>3 删除触发器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 删除触发器 --&gt;</span></span><br><span class="line">DROP TRIGGER newproduct;</span><br></pre></td></tr></table></figure>
<h2 id="4-INSERT-触发器"><a href="#4-INSERT-触发器" class="headerlink" title="4 INSERT 触发器"></a>4 INSERT 触发器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER neworder AFTER INSERT ON orders FOR EACH ROW SELECT NEW.order_num;</span><br></pre></td></tr></table></figure>
<h2 id="5-DELETE-触发器"><a href="#5-DELETE-触发器" class="headerlink" title="5 DELETE 触发器"></a>5 DELETE 触发器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER deleteorder BEFORE DELETE ON orders FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">	INSERT INTO archive_orders(order_num, order_date, cust_id)</span><br><span class="line">	VALUES(OLD.order_num, OLD.order_date, OLD.CUST_ID);</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
<h2 id="6-UPDATE-触发器"><a href="#6-UPDATE-触发器" class="headerlink" title="6 UPDATE 触发器"></a>6 UPDATE 触发器</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER updatevendor BEFORE UPDATE ON vendors</span><br><span class="line">FOR EACH ROW SET.vend_state = Upper(NEW.vend_state);</span><br></pre></td></tr></table></figure>
<h1 id="十六、-事物处理"><a href="#十六、-事物处理" class="headerlink" title="十六、 事物处理"></a>十六、 事物处理</h1><h2 id="1-事物处理"><a href="#1-事物处理" class="headerlink" title="1 事物处理"></a>1 事物处理</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 事物处理 --&gt;</span></span><br><span class="line">可以用于维护数据库的完整性,即保证同一批次的MySQL操作要么全部操作成功,要么全部操作失败。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 事物处理的几个术语 --&gt;</span></span><br><span class="line">事物(transaction):指的是一组SQL语句;</span><br><span class="line">回退(rollback):指的是撤销指定SQL语句的过程;</span><br><span class="line">提交(commit):将未存储的SQL语句结果写入数据库表;</span><br><span class="line">保留点(savepoint):指事物处理中设置的临时占位符(place-holder),可以对这一操作进行回退。</span><br></pre></td></tr></table></figure>
<h2 id="2-控制事物处理"><a href="#2-控制事物处理" class="headerlink" title="2 控制事物处理"></a>2 控制事物处理</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 标识事物开始 --&gt;</span></span><br><span class="line">START TRANSACTION</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用ROLLBACK --&gt;</span></span><br><span class="line">SELECT * FROM ordertotals; <span class="comment">&lt;!--显示记录--&gt;</span></span><br><span class="line">START TRANSACTION;		  <span class="comment">&lt;!--开始事物--&gt;</span></span><br><span class="line">DELETE FROM ordertotals;  <span class="comment">&lt;!--删除记录--&gt;</span></span><br><span class="line">SELECT * FROM ordertotals; <span class="comment">&lt;!--显示空的记录表--&gt;</span></span><br><span class="line">ROLLBACK;                  <span class="comment">&lt;!--事物回退--&gt;</span></span><br><span class="line">SELECT * FROM ordertotals;  <span class="comment">&lt;!--重新显示记录--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 可以回退的SQL语句 --&gt;</span></span><br><span class="line">INSERT</span><br><span class="line">UPDATE</span><br><span class="line">DELETE</span><br><span class="line"><span class="comment">&lt;!-- 不能回退的SQL语句 --&gt;</span></span><br><span class="line">SELECT</span><br><span class="line">CREATE</span><br><span class="line">DROP</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MySQL中的SQL语句都是针对数据库表执行和表写的,一般都是隐含提交(implicit commit)。即提交操作自动进行。</span><br><span class="line">但是在事物处理中,提交并不会自动执行,所以就需要用到 COMMIT 语句。</span><br><span class="line"><span class="comment">&lt;!-- 使用COMMIT --&gt;</span></span><br><span class="line">START TRANSACTION;</span><br><span class="line">DELETE FROM orderitems WHERE order_num = 10000; <span class="comment">&lt;!--删除记录--&gt;</span></span><br><span class="line">DELETE FROM orders WHERE order_num=10000;       <span class="comment">&lt;!--若上一条记录删除失败,则不会执行COMMIT操作--&gt;</span></span><br><span class="line">COMMIT;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 更改默认的提交行为 --&gt;</span></span><br><span class="line">SET autocommit=0;</span><br><span class="line">autocommit针对的是每个连接而不是服务器。</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 使用保留点 --&gt;</span></span><br><span class="line">可以支持回到部分事物处理</span><br><span class="line">SAVEPOINT delete1;  <span class="comment">&lt;!--保留点应取唯一名字--&gt;</span></span><br><span class="line">ROLLBACK TO delete1;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 释放保留点 --&gt;</span></span><br><span class="line">MySQL5之后支持释放保留点</span><br><span class="line">RELEASE SAVEPOINT</span><br></pre></td></tr></table></figure>
<h1 id="十七、-存储过程"><a href="#十七、-存储过程" class="headerlink" title="十七、 存储过程"></a>十七、 存储过程</h1><h2 id="1-使用存储过程的原因"><a href="#1-使用存储过程的原因" class="headerlink" title="1 使用存储过程的原因"></a>1 使用存储过程的原因</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 原因 --&gt;</span></span><br><span class="line">优点：</span><br><span class="line">a.将接口封装在易于使用的单元中,简化复杂的操作。</span><br><span class="line">b.不要求反复建立一系列处理步骤,保证了数据的安全性。因为程序执行的步骤越多,出错的概率也就越大。</span><br><span class="line">c.简化对变动的管理。即安全性。</span><br><span class="line">d.提高性能。使用存储过程比使用单独的SQL语句要快。</span><br><span class="line">e.存在只能用在单个请求中的MySQL元素和特性,存储过程即可以使用他们来编写功能更强更灵活的代码。</span><br><span class="line">总结上述：即简单、安全、高性能。</span><br><span class="line">缺点：</span><br><span class="line">a.编写比SQL语句复杂。</span><br><span class="line">b.没有创建存储过程的安全访问权限。</span><br></pre></td></tr></table></figure>
<h2 id="2-存储过程的使用"><a href="#2-存储过程的使用" class="headerlink" title="2 存储过程的使用"></a>2 存储过程的使用</h2><h4 id="2-1-创建存储过程"><a href="#2-1-创建存储过程" class="headerlink" title="2.1 创建存储过程"></a>2.1 创建存储过程</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 临时更改MySQL命令行客户机的分隔符 --&gt;</span></span><br><span class="line">DELEMITER //  <span class="comment">&lt;!--告诉程序使用 // 作为临时结束分隔符--&gt;</span></span><br><span class="line">CREATE PROCEDURE productpricing()</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT Avg(prod_price) AS priceaverage</span><br><span class="line">	FROM products</span><br><span class="line">END //    <span class="comment">&lt;!--标志存储过程结束--&gt;</span></span><br><span class="line">DELIMITER ;  <span class="comment">&lt;!--恢复原来的分隔符--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 注意 --&gt;</span></span><br><span class="line">\ 符号不能作为语句分隔符,其余均可。</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用存储过程 --&gt;</span></span><br><span class="line">CALL productpricing()</span><br></pre></td></tr></table></figure>
<h4 id="2-2-删除存储过程"><a href="#2-2-删除存储过程" class="headerlink" title="2.2 删除存储过程"></a>2.2 删除存储过程</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE productpricing;</span><br><span class="line"><span class="comment">&lt;!-- 注意 --&gt;</span></span><br><span class="line">a.后边没有使用 ()</span><br><span class="line">b.过程不存在,则会报错;可使用DROP PROCEDURE IF EXISTS productpricing</span><br></pre></td></tr></table></figure>
<h4 id="2-3-配合参数使用"><a href="#2-3-配合参数使用" class="headerlink" title="2.3 配合参数使用"></a>2.3 配合参数使用</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 创建 --&gt;</span></span><br><span class="line">CREATE PROCEDURE productpricing(</span><br><span class="line">	OUT pl DECIMAL(8,2),  <span class="comment">&lt;!--out关键字指出相应参数用来从存储过程传出值给调用者,IN表示传递给存储过程--&gt;</span></span><br><span class="line">	OUT ph DECIMAL(8,2),  <span class="comment">&lt;!--INOUT表示对存储过程传入和传出--&gt;</span></span><br><span class="line">	OUT pa DECIMAL(8,2),  <span class="comment">&lt;!--DECIMAL为数据类型--&gt;</span></span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT Min(prod_price) INTO pl from products; <span class="comment">&lt;!--存储过程代码位于begin与end之间--&gt;</span></span><br><span class="line">	SELECT Max(prod_price) INTO ph from products; <span class="comment">&lt;!--通过INTO关键字保存至相应的变量--&gt;</span></span><br><span class="line">	SELECT Avg(prod_price) INTO pa from products;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 使用 --&gt;</span></span><br><span class="line">CALL productpricing(@pricelow,</span><br><span class="line">				   @pricehigh,</span><br><span class="line">				   @priceaverage);</span><br><span class="line">这条语句并不会显示任何数据。仅仅是返回以后可以显示的变量;若想要显示数据,可以使用一下语句：</span><br><span class="line">SELECT @pricehigh, @pricelow, @priceaverage;</span><br></pre></td></tr></table></figure>
<h4 id="2-4-检查存储过程"><a href="#2-4-检查存储过程" class="headerlink" title="2.4 检查存储过程"></a>2.4 检查存储过程</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE PROCEDURE ordertotal; <span class="comment">&lt;!--显示传建一个存储过程的create语句--&gt;</span></span><br><span class="line">SHOW PROCEDURE STATUS;  <span class="comment">&lt;!--显示何时、有谁创建等详细信息的存储过程--&gt;</span></span><br><span class="line">SHOW PROCEDURE STATUS LIKE 'ORDERTOTAL'; <span class="comment">&lt;!--过滤模式--&gt;</span></span><br></pre></td></tr></table></figure>

        </div>

        <section class="meta">
            <time class="time" itemprop="dateUpdated" datetime="2018-12-03T20:28:45+08:00" content="2018-12-03">
                <i class="fas fa-pen fa-fw" aria-hidden="true"></i>
                本文最后更新于：2018-12-03
            </time>
            
                
                <div class="tags">
                    <i class="fas fa-tags fa-fw" aria-hidden="true"></i>
                    <a class="tag" href="/tags/MySQL/">MySQL</a>, <a class="tag" href="/tags/sql/">sql</a>
                </div>
            
        </section>

        
            <div class="prev-next">
                
                    <section class="prev">
                        <span class="art-item-left">
                            <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一篇</h6>
                            <h4>
                                <a href="/2018/12/03/Nginx部署/" rel="prev" title="WEB服务器之Nginx">
                                  
                                      WEB服务器之Nginx
                                  
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <i class="fas fa-tags fa-fw" aria-hidden="true"></i>
                                    <a class="tag" href="/tags/Nginx/">Nginx</a>, <a class="tag" href="/tags/uWSGI/">uWSGI</a>
                                </h6>
                            
                        </span>
                    </section>
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一篇&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/2018/12/03/Python实现23种设计模式/" rel="prev" title="Python实现23种设计模式">
                                    
                                        Python实现23种设计模式
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <i class="fas fa-tags fa-fw" aria-hidden="true"></i>
                                    <a class="tag" href="/tags/Python/">Python</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        

    </section>

</article>

<br>

<!-- 显示推荐文章和评论 -->

    <article class="post white-box comments">
        <section class="article typo">

            
                

    <div class="recommended_posts">
        <h4><i class="fas fa-bookmark fa-fw" aria-hidden="true"></i>&nbsp;你可能感兴趣的文章</h4>
        <ul>
            
                <li><a href="http://yoursite.com/2018/12/03/Nginx部署/">WEB服务器之Nginx</a></li>
            
                <li><a href="http://yoursite.com/2018/12/03/Python实现23种设计模式/">Python实现23种设计模式</a></li>
            
                <li><a href="http://yoursite.com/2018/12/03/设计模式/">设计模式</a></li>
            
                <li><a href="http://yoursite.com/2018/12/03/Git/">Git的使用</a></li>
            
                <li><a href="http://yoursite.com/2018/12/03/Django/">Django基础知识</a></li>
            
        </ul>
    </div>


            

            

                

                
                    <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;LiveRe评论</h4>
                    <section id="comments">
                        <div id="lv-container" data-id="city" data-uid="MTAyMC80MTQxNi8xNzk2Mw==">
                            <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
                        </div>
                    </section>
                

                
            

        </section>
    </article>


<script>
    window.subData = {
        title: 'MySQL基础知识',
        tools: true
    }
</script>


        </div>
        <aside class='l_side'>
            
    
        
  <section class="m_widget author">
    
      <div class="header">
        <img class="avatar" src="https://xaoxuu.com/assets/img/avatar.jpg">
      </div>
    
    
      <div class="content">
        
        
          <p>最佳第六人</p>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="mailto:zhuohfeng@163.com" class="social flat-box" target="_blank" rel="external"><i class="social fas fa-envelope" aria-hidden="true"></i></a>
          
        
          
            <a href="https://github.com/smart1san" class="social flat-box" target="_blank" rel="external"><i class="social fab fa-github-square" aria-hidden="true"></i></a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=438614298" class="social flat-box" target="_blank" rel="external"><i class="social fas fa-headphones-alt" aria-hidden="true"></i></a>
          
        
      </div>
    
  </section>


    
    
        
  <section class="m_widget announcement">
    <header class="header pure">
        <div><i class="fas fa-bullhorn fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;公告</div>
    </header>
    <div class="content pure">
      在墨黑的夜空点燃自己，为远方的你送去一丝光明....那全部的幸福，都源自燃烧的我，暗夜中模糊的你....
    </div>
  </section>


    
    
        <section class="m_widget categories">
    <header class="header pure">
        <div><i class="fas fa-bookmark fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;分类</div>
    </header>
    <div class="content pure">
        
            <ul class="entry">
                
                    <li><a class="flat-box" href="/categories/Database/"><div class="name">Database</div><div class="badge">1</div></a></li>
                
                    <li><a class="flat-box" href="/categories/Django/"><div class="name">Django</div><div class="badge">1</div></a></li>
                
                    <li><a class="flat-box" href="/categories/Git/"><div class="name">Git</div><div class="badge">1</div></a></li>
                
                    <li><a class="flat-box" href="/categories/Nginx/"><div class="name">Nginx</div><div class="badge">1</div></a></li>
                
                    <li><a class="flat-box" href="/categories/Python/"><div class="name">Python</div><div class="badge">1</div></a></li>
                
                    <li><a class="flat-box" href="/categories/设计模式/"><div class="name">设计模式</div><div class="badge">1</div></a></li>
                
            </ul>
        
    </div>
</section>

    
    
        
    <section class="m_widget tagcloud">
        <header class="header pure">
            <div><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;标签</div>
        </header>
        <div class="content pure">
            <a href="/tags/Git/" style="font-size: 14px; color: #999">Git</a> <a href="/tags/MTV/" style="font-size: 14px; color: #999">MTV</a> <a href="/tags/MySQL/" style="font-size: 14px; color: #999">MySQL</a> <a href="/tags/Nginx/" style="font-size: 14px; color: #999">Nginx</a> <a href="/tags/Python/" style="font-size: 14px; color: #999">Python</a> <a href="/tags/restframework/" style="font-size: 14px; color: #999">restframework</a> <a href="/tags/sql/" style="font-size: 14px; color: #999">sql</a> <a href="/tags/uWSGI/" style="font-size: 14px; color: #999">uWSGI</a>
        </div>
    </section>


    
    
        
    <section class="m_widget toc-wrapper">
        <header class="header pure">
            <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;目录</div>
            <div class="wrapper"><a class="s-toc rightBtn" title="固定到顶部" target="_blank" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div>
        </header>
        <div class="content pure">
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#一、-Mysql简单认识"><span class="toc-text">一、 Mysql简单认识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-数据（Data）的概念"><span class="toc-text">1.1 数据（Data）的概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-数据库（DataBase）的概念"><span class="toc-text">1.2 数据库（DataBase）的概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-表（table）"><span class="toc-text">1.3 表（table）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-记录"><span class="toc-text">1.4 记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-主键（primary-key）"><span class="toc-text">1.5 主键（primary key）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-数据库服务器、数据库管理系统、数据库、表与记录的关系-重点在于理解"><span class="toc-text">1.6 数据库服务器、数据库管理系统、数据库、表与记录的关系(重点在于理解)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-SQL的概念"><span class="toc-text">2 SQL的概念</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#二、-Mysql基础操作"><span class="toc-text">二、 Mysql基础操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-连接MySQL"><span class="toc-text">1 连接MySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-选择数据库"><span class="toc-text">2 选择数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-常用数据库和表的SQL-语句"><span class="toc-text">3 常用数据库和表的SQL 语句</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#三、-检索数据"><span class="toc-text">三、 检索数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-select语句"><span class="toc-text">1 select语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-排序检索数据"><span class="toc-text">2 排序检索数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-过滤数据"><span class="toc-text">3 过滤数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-数据过滤升级"><span class="toc-text">4 数据过滤升级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-用通配符进行过滤"><span class="toc-text">5 用通配符进行过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-正则"><span class="toc-text">6 正则</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#四、-字段"><span class="toc-text">四、 字段</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-字段"><span class="toc-text">1 字段</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#五、-聚合函数"><span class="toc-text">五、 聚合函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-聚合函数"><span class="toc-text">1 聚合函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#六、-数据分组"><span class="toc-text">六、 数据分组</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-创建分组"><span class="toc-text">1 创建分组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-过滤分组"><span class="toc-text">2 过滤分组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-分组和排序"><span class="toc-text">3 分组和排序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#七、-关键词执行顺序汇总"><span class="toc-text">七、 关键词执行顺序汇总</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#八、-子查询和组合查询"><span class="toc-text">八、 子查询和组合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-子查询"><span class="toc-text">1 子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-组合查询"><span class="toc-text">2 组合查询</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#九、-联结表和创建高级联结"><span class="toc-text">九、 联结表和创建高级联结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-联结"><span class="toc-text">1 联结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-高级联结"><span class="toc-text">2 高级联结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十、-数据操作"><span class="toc-text">十、 数据操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-插入数据"><span class="toc-text">1 插入数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-更新数据"><span class="toc-text">2 更新数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-删除数据"><span class="toc-text">3 删除数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十一、-表操作"><span class="toc-text">十一、 表操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-创建表"><span class="toc-text">1 创建表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-更新表"><span class="toc-text">2 更新表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-删除表"><span class="toc-text">3 删除表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-重命名表"><span class="toc-text">4 重命名表</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十二、-视图"><span class="toc-text">十二、 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-视图"><span class="toc-text">1 视图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十三、-游标"><span class="toc-text">十三、 游标</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-游标"><span class="toc-text">1 游标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-使用游标"><span class="toc-text">2 使用游标</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-创建游标"><span class="toc-text">2.1 创建游标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-打开和关闭游标"><span class="toc-text">2.2 打开和关闭游标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-使用游标数据"><span class="toc-text">2.3 使用游标数据</span></a></li></ol></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#十五、-触发器"><span class="toc-text">十五、 触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-触发器"><span class="toc-text">1 触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-创建触发器"><span class="toc-text">2 创建触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-删除触发器"><span class="toc-text">3 删除触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-INSERT-触发器"><span class="toc-text">4 INSERT 触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-DELETE-触发器"><span class="toc-text">5 DELETE 触发器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-UPDATE-触发器"><span class="toc-text">6 UPDATE 触发器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十六、-事物处理"><span class="toc-text">十六、 事物处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-事物处理"><span class="toc-text">1 事物处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-控制事物处理"><span class="toc-text">2 控制事物处理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#十七、-存储过程"><span class="toc-text">十七、 存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-使用存储过程的原因"><span class="toc-text">1 使用存储过程的原因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-存储过程的使用"><span class="toc-text">2 存储过程的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-创建存储过程"><span class="toc-text">2.1 创建存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-删除存储过程"><span class="toc-text">2.2 删除存储过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-配合参数使用"><span class="toc-text">2.3 配合参数使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-检查存储过程"><span class="toc-text">2.4 检查存储过程</span></a></li></ol></li></ol></li>
        </div>
    </section>


    
    
        <section class="m_widget music">
    <header class="header pure">
        <div><i class="fas fa-headphones fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;音乐</div>
        <a class="rightBtn" title="打开博主的网易云音乐主页" target="_blank" rel="external nofollow noopener noreferrer" href="https://music.163.com/#/playlist?id=2456408175"><i class="fas fa-external-link-square-alt fa-fw"></i></a>
    </header>
    <div class="content pure">
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="100%" height="450" src="//music.163.com/outchain/player?type=0&id=2456408175&auto=0&height=450"></iframe>
    </div>
</section>

    
    
        <section class="m_widget links">
    <header class="header pure">
        <div><i class="fas fa-handshake fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;友链</div>
        
            <a class="rightBtn" title="联系博主添加友链" target="_blank" rel="external nofollow noopener noreferrer" href="mailto:me@xaoxuu.com?subject=交换友链&body=你好，我想和你交换友链，我已经将【VIP】添加到我的博客的友链中。我的博客链接是："><i class="fas fa-plus fa-fw"></i></a>
        
    </header>
    <div class="content pure">
        <ul class="entry" id="links">
            
                <li><a class="flat-box" title="https://github.com/smart1san" target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/smart1san">
                    <div class="name">
                        
                            <img src="https://xaoxuu.com/assets/img/avatar.jpg">
                        
                        &nbsp;&nbsp;smart1san&#39;s github
                    </div>
                </a></li>
            
        </ul>
    </div>
</section>

    


        </aside>
        <script>setLoadingBarProgress(60);</script>
    </div>
    </div>
    <footer id="footer" class="clearfix">
    
        <div class="social-wrapper">
          
              
                  <a href="mailto:zhuohfeng@163.com" class="social fas fa-envelope flat-box" target="_blank" rel="external"></a>
              
          
              
                  <a href="https://github.com/smart1san" class="social fab fa-github-square flat-box" target="_blank" rel="external"></a>
              
          
              
                  <a href="https://music.163.com/#/user/home?id=438614298" class="social fas fa-headphones-alt flat-box" target="_blank" rel="external"></a>
              
          
        </div>
    
    <br>
    <div>博客内容遵循 <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="licenses">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></div>
    <div>
        本站总访问量为 <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span> 次。
    </div>
</footer>
<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->


    <script>setLoadingBarProgress(80);</script>
    <script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/node-waves/0.7.5/waves.min.js"></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<!-- 访问统计 -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<script src="/js/jquery.fitvids.js"></script>

    <script>
        var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
        var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
        var ALGOLIA_API_KEY = "";
        var ALGOLIA_APP_ID = "";
        var ALGOLIA_INDEX_NAME = "";
        var AZURE_SERVICE_NAME = "";
        var AZURE_INDEX_NAME = "";
        var AZURE_QUERY_KEY = "";
        var BAIDU_API_ID = "";
        var SEARCH_SERVICE = "hexo" || "hexo";
        var ROOT = "/"||"/";
        if(!ROOT.endsWith('/'))ROOT += '/';
    </script>

<script src="/js/search.js"></script>
<script src="/js/app.js"></script>


    
    
        <script type="text/javascript">
           (function(d, s) {
               var j, e = d.getElementsByTagName(s)[0];
               if (typeof LivereTower === 'function') { return; }
               j = d.createElement(s);
               j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
               j.async = true;
               e.parentNode.insertBefore(j, e);
           })(document, 'script');
        </script>
    
    




  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("", "");</script>
  <script>
  function showTime(Counter) {
    var query = new AV.Query(Counter);
    var entries = [];
    var $visitors = $(".leancloud_visitors");

    $visitors.each(function () {
      entries.push( $(this).attr("id").trim() );
    });

    query.containedIn('url', entries);
    query.find()
      .done(function (results) {
        var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

        if (results.length === 0) {
          $visitors.find(COUNT_CONTAINER_REF).text(0);
          return;
        }

        for (var i = 0; i < results.length; i++) {
          var item = results[i];
          var url = item.get('url');
          var time = item.get('time');
          var element = document.getElementById(url);

          $(element).find(COUNT_CONTAINER_REF).text(time);
        }
        for(var i = 0; i < entries.length; i++) {
          var url = entries[i];
          var element = document.getElementById(url);
          var countSpan = $(element).find(COUNT_CONTAINER_REF);
          if( countSpan.text() == '') {
            countSpan.text(0);
          }
        }
      })
      .fail(function (object, error) {
        console.log("Error: " + error.code + " " + error.message);
      });
  }

  function addCount(Counter) {
    var $visitors = $(".leancloud_visitors");
    var url = $visitors.attr('id').trim();
    var title = $visitors.attr('data-flag-title').trim();
    var query = new AV.Query(Counter);

    query.equalTo("url", url);
    query.find({
      success: function(results) {
        if (results.length > 0) {
          var counter = results[0];
          counter.fetchWhenSave(true);
          counter.increment("time");
          counter.save(null, {
            success: function(counter) {
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text(counter.get('time'));
            },
            error: function(counter, error) {
              console.log('Failed to save Visitor num, with error message: ' + error.message);
            }
          });
        } else {
          var newcounter = new Counter();
          /* Set ACL */
          var acl = new AV.ACL();
          acl.setPublicReadAccess(true);
          acl.setPublicWriteAccess(true);
          newcounter.setACL(acl);
          /* End Set ACL */
          newcounter.set("title", title);
          newcounter.set("url", url);
          newcounter.set("time", 1);
          newcounter.save(null, {
            success: function(newcounter) {
              var $element = $(document.getElementById(url));
              $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
            },
            error: function(newcounter, error) {
              console.log('Failed to create');
            }
          });
        }
      },
      error: function(error) {
        console.log('Error:' + error.code + " " + error.message);
      }
    });
  }

  $(function() {
    var Counter = AV.Object.extend("Counter");
    if ($('.leancloud_visitors').length == 1) {
      addCount(Counter);
    } else if ($('.post-title-link').length > 1) {
      showTime(Counter);
    }
  });
</script>


    <script>setLoadingBarProgress(100);</script>
</body>
